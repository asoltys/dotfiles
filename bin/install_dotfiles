#!/bin/bash
sudo apt-get update
sudo apt-get install vim git curl xclip build-essential tmux hub fasd -yy
curl -fsSL https://get.pnpm.io/install.sh | sh -

rsync -ar ~/dotfiles/ ~/

echo "Enter password"
read -s password

openssl aes-256-cbc -d -in ~/.github_credentials.enc -k $password -out ~/.github_credentials
openssl aes-256-cbc -d -in ~/.dropbox_credentials.enc -k $password -out ~/.dropbox_credentials
openssl aes-256-cbc -d -in ~/.netrc.enc -k $password -out ~/.netrc
openssl aes-256-cbc -d -in ~/.id_rsa.enc -k $password -out ~/.ssh/id_rsa
openssl aes-256-cbc -d -a -in ~/.git-credentials.enc -k $password -out ~/.git-credentials
openssl aes-256-cbc -d -a -in ~/.gitconfig_secrets.enc -k $password -out ~/.gitconfig_secrets
openssl aes-256-cbc -d -a -in ~/.ssh/config.enc -k $password -out ~/.ssh/config
echo "*" > ~/.git/info/exclude
ln -sf /usr/bin/git ~/bin/gits
chmod 600 ~/.ssh/id_rsa

if [ ! -d ~/.vim ]; then
  git clone https://github.com/asoltys/vim ~/.vim
  cd ~/.vim
  git submodule update --init
  ln s ~/.vim/.vimrc ~/.vimrc
fi

if [ ! -d ~/.config/base16-shell ]; then
  git clone https://github.com/chriskempson/base16-shell.git ~/.config/base16-shell
  source ~/.config/base16-shell/profile_helper.sh
  base16_default-dark
fi

git clone https://github.com/nfultz/fzf-jump
git clone --depth 1 https://github.com/junegunn/fzf.git ~/.fzf
~/.fzf/install

source ~/.bashrc

rm -rf ~/dotfiles

echo "Installation complete"
exit
