#!/bin/bash
sudo apt-get install ruby vim git curl ack-grep exuberant-ctags -yyq
rsync -ar ~/dotfiles/ ~/

echo "Enter password"
read -s password
openssl aes-256-cbc -d -in ~/.github_credentials.enc -k $password -out ~/.github_credentials
openssl aes-256-cbc -d -in ~/.dropbox_credentials.enc -k $password -out ~/.dropbox_credentials
openssl aes-256-cbc -d -in ~/.netrc.enc -k $password -out ~/.netrc
openssl aes-256-cbc -d -in ~/.id_rsa.enc -k $password -out ~/.ssh/id_rsa
openssl aes-256-cbc -d -a -in ~/.gitconfig.enc -k $password -out ~/.gitconfig
openssl aes-256-cbc -d -in ~/.ssh/.config.enc -k $password -out ~/.ssh/config
echo "*" > ~/.git/info/exclude
ln -sf /usr/bin/git ~/bin/gits
chmod 600 ~/.ssh/id_rsa

if [ ! -d ~/.vim ]; then
  git clone https://github.com/asoltys/vim ~/.vim
  cd ~/.vim
  git submodule update --init
  cp --remove-destination ~/.vim/.vimrc ~
fi

if [ ! -d ~/.hub ]; then
  git clone https://github.com/github/hub ~/.hub
  cd ~/.hub
  make install prefix=/usr/local
fi

if [ ! -d ~/.bash-it ]; then
  git clone --depth=1 https://github.com/Bash-it/bash-it.git ~/.bash_it
  ~/.bash_it/install.sh --silent --no-modify-config
fi

source ~/.bashrc

echo "Installation complete"
exit
